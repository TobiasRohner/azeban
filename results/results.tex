\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage[margin=2cm]{geometry}
\usepackage[section]{placeins}



\newcommand{\burgerssine}[1]{%
	\begin{figure}[h!]
		\centering
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{burgers_sine/burgers_sine_N#1_T0.000000}
		\end{subfigure}
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{burgers_sine/burgers_sine_N#1_T0.025000}
		\end{subfigure}
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{burgers_sine/burgers_sine_N#1_T0.050000}
		\end{subfigure}
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{burgers_sine/burgers_sine_N#1_T0.075000}
		\end{subfigure}
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{burgers_sine/burgers_sine_N#1_T0.100000}
		\end{subfigure}
		\caption{Time evolution for $N = #1$}
	\end{figure}
}

\newcommand{\burgersshock}[1]{%
	\begin{figure}[h!]
		\centering
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{burgers_shock/burgers_shock_N#1_T0.000000}
		\end{subfigure}
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{burgers_shock/burgers_shock_N#1_T0.250000}
		\end{subfigure}
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{burgers_shock/burgers_shock_N#1_T0.500000}
		\end{subfigure}
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{burgers_shock/burgers_shock_N#1_T0.750000}
		\end{subfigure}
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{burgers_shock/burgers_shock_N#1_T1.000000}
		\end{subfigure}
		\caption{Time evolution for $N = #1$}
	\end{figure}
}

\newcommand{\taylorvortex}[1]{%
	\begin{figure}[h!]
		\centering
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{euler_taylor_vortex/euler_taylor_vortex_N#1_T0.000000}
		\end{subfigure}
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{euler_taylor_vortex/euler_taylor_vortex_N#1_T0.010000}
		\end{subfigure}
		\caption{Time evolution for $N = #1$}
	\end{figure}
}

\newcommand{\doubleshearlayer}[1]{%
	\begin{figure}[h!]
		\centering
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{euler_double_shear_layer/euler_double_shear_layer_N#1_T0.000000}
		\end{subfigure}
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{euler_double_shear_layer/euler_double_shear_layer_N#1_T0.500000}
		\end{subfigure}
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{euler_double_shear_layer/euler_double_shear_layer_N#1_T0.750000}
		\end{subfigure}
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{euler_double_shear_layer/euler_double_shear_layer_N#1_T0.900000}
		\end{subfigure}
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{euler_double_shear_layer/euler_double_shear_layer_N#1_T1.000000}
		\end{subfigure}
		\caption{Time evolution for $N = #1$}
	\end{figure}
}

\newcommand{\discontinuousvortexpatch}[1]{%
	\begin{figure}[h!]
		\centering
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{euler_discontinuous_vortex_patch/euler_discontinuous_vortex_patch_N#1_T0.000000}
		\end{subfigure}
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{euler_discontinuous_vortex_patch/euler_discontinuous_vortex_patch_N#1_T2.500000}
		\end{subfigure}
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{euler_discontinuous_vortex_patch/euler_discontinuous_vortex_patch_N#1_T5.000000}
		\end{subfigure}
		\caption{Time evolution for $N = #1$}
	\end{figure}
}



\begin{document}
	
\section{Burgers Sine}
	This experiment has initial conditions $u_0(x) = \sin(2\pi x)$ and is simulated until $t = 0.1$ in order for the solution to stay continuous over the whole simulation time. The spectral viscosity is applied to all frequencies and is given by $\nu = \frac{0.25}{N}$.
	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.7\textwidth,height=\textheight,keepaspectratio]{burgers_sine/burgers_sine_convergence.png}
		\caption{Convergence of the Burgers solver for the sine initial conditions}
	\end{figure}
	\burgerssine{00064}
	\burgerssine{00128}
	\burgerssine{00256}
	\burgerssine{00512}
	\burgerssine{01024}
	\burgerssine{02048}
	\burgerssine{04096}
	\burgerssine{08192}
	
\section{Burgers Shock}
	This experiment has initial conditions $u_0(x) = \mathbb{1}_{[0.25, 0.5]}(x)$ and therefore tests Burgers equation for shocks and rarefactions. The spectral viscosity is applied to all frequencies and is given by $\nu = \frac{0.25}{N}$.
	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.7\textwidth,height=\textheight,keepaspectratio]{burgers_shock/burgers_shock_convergence.png}
		\caption{Convergence of the Burgers solver for the shock initial conditions}
	\end{figure}
	\burgersshock{00064}
	\burgersshock{00128}
	\burgersshock{00256}
	\burgersshock{00512}
	\burgersshock{01024}
	\burgersshock{02048}
	\burgersshock{04096}
	\burgersshock{08192}
	
\section{2D Euler Taylor Vortex}
	This experiment solves the Euler equations on the domain $[-8, 8]^2$ with initial conditions
	\begin{align*}
		u_0(x, y) &= -y e^{\frac{1}{2}(1 - x^2 - y^2)} + 8 \\
		v_0(x, y) &=  x e^{\frac{1}{2}(1 - x^2 - y^2)}
	\end{align*}
	The spectral viscosity is applied to all frequencies and is given by $\nu = \frac{0.05}{N}$. The solution at time $t = 0.01$ is compared to a reference solution computed using a high-order WENO scheme on a 8758x8758 grid.
	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.7\textwidth,height=\textheight,keepaspectratio]{euler_taylor_vortex/euler_taylor_vortex_convergence.png}
		\caption{Convergence of the 2D Euler solver for the Taylor Vortex initial conditions}
	\end{figure}
	\taylorvortex{00064}
	\taylorvortex{00128}
	\taylorvortex{00256}
	\taylorvortex{00512}
	\taylorvortex{01024}
	\begin{figure}[h!]
		\centering
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{euler_taylor_vortex/euler_taylor_vortex_N00064_T0.010000_diff.png}
			\caption{$N = 64$}
		\end{subfigure}
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{euler_taylor_vortex/euler_taylor_vortex_N00128_T0.010000_diff.png}
			\caption{$N = 128$}
		\end{subfigure}
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{euler_taylor_vortex/euler_taylor_vortex_N00256_T0.010000_diff.png}
			\caption{$N = 256$}
		\end{subfigure}
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{euler_taylor_vortex/euler_taylor_vortex_N00512_T0.010000_diff.png}
			\caption{$N = 512$}
		\end{subfigure}
		\begin{subfigure}{0.45\textwidth}
			\centering
			\includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{euler_taylor_vortex/euler_taylor_vortex_N01024_T0.010000_diff.png}
			\caption{$N = 1024$}
		\end{subfigure}
		\caption{Difference between the Taylor Vortex solved using the spectral method and a reference solution computed using a high-order WENO scheme on a grid with resolution 8758x8758.}
	\end{figure}

\section{2D Euler Double Shear Layer}
	This experiment solves the Euler equations on the domain $[0, 1]^2$ with initial conditions
	\begin{align*}
		u_0(x, y) &= \begin{cases}
			\tanh\left(\frac{2\pi(y-\frac{1}{4})}{\rho}\right) &\mbox{ for } y < \frac{1}{2} \\
			\tanh\left(\frac{2\pi(\frac{3}{4}-y)}{\rho}\right) &\mbox{ for } y \geq \frac{1}{2}
		\end{cases} \\
		v_0(x, y) &= \delta \sin(2\pi x)
	\end{align*}
	with $\rho = 0.2$ and $\delta = 0.05$. The spectral viscosity is applied to all frequencies and is given by $\nu = \frac{0.05}{N}$.
	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.7\textwidth,height=\textheight,keepaspectratio]{euler_double_shear_layer/euler_double_shear_layer_convergence.png}
		\caption{Convergence of the 2D Euler solver for the Double Shear Layer initial conditions}
	\end{figure}
	\doubleshearlayer{00064}
	\doubleshearlayer{00128}
	\doubleshearlayer{00256}
	\doubleshearlayer{00512}
	\doubleshearlayer{01024}
	
\section{2D Euler Discontinuous Vortex Patch}
	This experiment solves the Euler equations on the domain $[0, 1]^2$ with initial conditions
	\begin{align*}
		u_0(x, y) &= \begin{cases}
			-\frac{1}{2}(y-\frac{1}{2}) &\mbox{ for } \sqrt{x^2+y^2} < \frac{1}{4} \\
			0 &\mbox{ otherwise}
		\end{cases} \\
		v_0(x, y) &= \begin{cases}
			\frac{1}{2}(x-\frac{1}{2}) &\mbox{ for } \sqrt{x^2+y^2} < \frac{1}{4} \\
			0 &\mbox{ otherwise}
		\end{cases}
	\end{align*}
	The spectral viscosity is applied to all frequencies and is given by $\nu = \frac{0.05}{N}$. For low resolutions, we can observe some rounding errors originating from the Leray Projection applied to discontinuous initial data. However, they vanish with increasing resolution.
	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.7\textwidth,height=\textheight,keepaspectratio]{euler_discontinuous_vortex_patch/euler_discontinuous_vortex_patch_convergence.png}
		\caption{Convergence of the 2D Euler solver for the Discontinuous Vortex Patch initial conditions}
	\end{figure}
	\discontinuousvortexpatch{00064}
	\discontinuousvortexpatch{00128}
	\discontinuousvortexpatch{00256}
	\discontinuousvortexpatch{00512}
	\discontinuousvortexpatch{01024}
	
\end{document}